<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Group Speed Dial Pro</title>
  <!-- Usando Inter font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script type="module" crossorigin src="/newtab.js"></script>
  <link rel="modulepreload" crossorigin href="/api.js">
  <link rel="stylesheet" crossorigin href="/api.css">
</head>

<body>
  <div id="app">
    <!-- Top Navigation for Groups & Settings -->
    <header class="glass-header">
      <div class="groups-nav-wrapper">
        <div class="groups-nav" id="groups-container">
          <!-- Groups rendered by JS -->
        </div>
        <div class="groups-actions-wrapper" style="display: flex; flex-direction: row; align-items: center; gap: 6px;">
          <div class="scroll-v-actions" style="display: flex; flex-direction: column; gap: 4px;">
            <button id="scroll-up-btn" class="scroll-btn hidden">‚ñ≤</button>
            <button id="scroll-down-btn" class="scroll-btn hidden">‚ñº</button>
          </div>
          <button id="add-group-tab-btn" data-i18n-title="addGroup" title="A√±adir Grupo"
            style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.05); color: white; border-radius: 4px; padding: 8px 10px; font-weight: bold; font-size: 1.2rem; line-height: 1; cursor: pointer; transition: background 0.2s;">+</button>
        </div>
      </div>

      <div class="actions">
        <button id="add-group-btn" class="btn-icon" title="A√±adir Grupo">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
            <path d="M12 5v14M5 12h14" />
          </svg>
        </button>
        <div class="separator"></div>
        <button id="add-btn" class="btn-primary">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
            <path d="M12 5v14M5 12h14" />
          </svg><span data-i18n="addBookmark">A√±adir Marcador</span></button>
        <div class="dropdown-wrapper" id="dropdown-wrapper">
          <button id="settings-btn" class="btn-icon" title="Opciones Menu">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
              <line x1="3" y1="12" x2="21" y2="12"></line>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
          </button>
          <div id="dropdown-menu" class="dropdown-menu hidden">
            <!-- Item con SUBMEN√ö -->
            <div class="dropdown-item has-submenu" id="menu-update-thumbnails-container">
              <button class="dropdown-btn-main" id="menu-update-thumbnails">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
                  <path d="M21 2v6h-6"></path>
                  <path d="M3 12a9 9 0 1 0 2.13-5.88L2 9"></path>
                </svg>
                <span data-i18n="updateThumbnails">Actualizar miniaturas</span>
                <!-- Chevron derecho para indicar sub-men√∫ -->
                <svg viewBox="0 0 24 24" fill="none" class="chevron-right" stroke="currentColor" stroke-width="2">
                  <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
              </button>

              <!-- El panel secundario que se despliega -->
              <div class="submenu-panel hidden" id="submenu-thumbnails">
                <button class="dropdown-item submenu-item" id="sub-update-group"><span data-i18n="updateAllSlidesInGroup">Actualizar todas las diapositivas en grupo</span></button>
                <button class="dropdown-item submenu-item" id="sub-update-missing">
                  Todas las que falten (despu√©s de la sincronizaci√≥n)
                </button>
                <button class="dropdown-item submenu-item" id="sub-update-all"><span data-i18n="updateAllSlideGroups">Todos los grupos de diapositivas</span></button>
              </div>
            </div>

            <div class="dropdown-item has-submenu" id="menu-advanced-container">
              <button class="dropdown-btn-main" id="menu-advanced">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
                  <path
                    d="M10 20.5V22H14V20.5C14.8 20.3 15.6 19.9 16.3 19.4L17.5 20.6L20.3 17.8L19.1 16.6C19.6 15.9 20 15 20.2 14.1H21.7V10.1H20.2C20 9.2 19.6 8.4 19.1 7.7L20.4 6.4L17.5 3.5L16.3 4.8C15.6 4.3 14.8 3.9 13.9 3.7V2.2H9.9V3.7C9.1 3.9 8.3 4.3 7.6 4.8L6.4 3.5L3.6 6.4L4.8 7.6C4.3 8.3 3.9 9.1 3.7 10H2.2V14H3.7C3.9 14.8 4.3 15.6 4.8 16.3L3.5 17.6L6.4 20.4L7.6 19.2C8.3 19.7 9.1 20.1 10 20.5ZM12 16.2C9.7 16.2 7.8 14.3 7.8 12C7.8 9.7 9.7 7.8 12 7.8C14.3 7.8 16.2 9.7 16.2 12C16.2 14.3 14.3 16.2 12 16.2Z" />
                </svg>
                <span data-i18n="advanced">Avanzado</span>
                <svg viewBox="0 0 24 24" fill="none" class="chevron-right" stroke="currentColor" stroke-width="2">
                  <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
              </button>

              <div class="submenu-panel hidden" id="submenu-advanced">
                <button class="dropdown-item submenu-item" id="sub-show-errors">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.1.9 2 2 2h12a2 2 0 0 0 2-2V8l-6-6z" />
                    <path d="M14 3v5h5M10 12h4v4h-4z" />
                  </svg>
                  <span data-i18n="showErrors">Mostrar registro de errores...</span>
                </button>
                <button class="dropdown-item submenu-item" id="sub-show-stats">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
                    <line x1="18" y1="20" x2="18" y2="10" />
                    <line x1="12" y1="20" x2="12" y2="4" />
                    <line x1="6" y1="20" x2="6" y2="14" />
                  </svg>
                  <span data-i18n="stats">Estad√≠sticas</span>
                </button>
              </div>
            </div>
            <button class="dropdown-item" id="menu-help">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M12 16v-1"></path>
                <path d="M12 8a2 2 0 1 1 2 2c-1 1-1 2-1 3"></path>
              </svg>
              <span data-i18n="help">Ayuda</span>
            </button>
            <button class="dropdown-item" id="menu-search-dial">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
              <span data-i18n="searchSlide">Buscar diapositiva</span>
            </button>
            <button class="dropdown-item" id="menu-share-dials">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
                <circle cx="18" cy="5" r="3"></circle>
                <circle cx="6" cy="12" r="3"></circle>
                <circle cx="18" cy="19" r="3"></circle>
                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
              </svg>
              <span data-i18n="shareSlides">Compartir diapositivas</span>
            </button>
            <button class="dropdown-item" id="menu-edit-group">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
                <path d="M12 20h9"></path>
                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
              </svg>
              <span data-i18n="editGroup">Editar grupo</span>
            </button>
            <button class="dropdown-item" id="menu-options">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
                <path
                  d="M12.22 2h-.44a2 2 0 0 0-2 2v1.5a1.5 1.5 0 0 1-2.6 1.5L5.85 5.8a2 2 0 0 0-2.83 0l-.3.3a2 2 0 0 0 0 2.83l1.2 1.2a1.5 1.5 0 0 1-1.5 2.6H1.5a2 2 0 0 0-2 2v.44a2 2 0 0 0 2 2h1.5a1.5 1.5 0 0 1 1.5 2.6l-1.2 1.2a2 2 0 0 0 0 2.83l.3.3a2 2 0 0 0 2.83 0l-1.2 1.2a1.5 1.5 0 0 1-2.6-1.5V4a2 2 0 0 0-2-2Z" />
                <circle cx="12" cy="12" r="3" />
              </svg>
              <span data-i18n="options">Opciones</span>
            </button>
            <button class="dropdown-item" id="menu-select-dials">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
                <polyline points="9 11 12 14 22 4"></polyline>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
              </svg>
              <span data-i18n="selectSlides">Seleccionar diapositivas</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <main class="dial-container" id="dial-grid">
      <!-- Rendered by JS based on Active Group -->
    </main>

    <!-- Modal Add/Edit DIAL -->
    <div id="modal" class="modal hidden">
      <div class="modal-content glass-panel">
        <div class="modal-header">
          <h2 id="modal-title"><span data-i18n="addBookmark">A√±adir Marcador</span></h2>
          <button id="close-modal" class="btn-icon">
            <!-- Close SVG -->
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>
        <form id="dial-form">
          <div class="form-group">
            <label for="dial-title" data-i18n="title">T√≠tulo</label>
            <input type="text" id="dial-title" required data-i18n-placeholder="titlePlaceholder" placeholder="Ej: Google" autocomplete="off">
          </div>
          <div class="form-group">
            <label for="dial-url" data-i18n="url">URL</label>
            <input type="url" id="dial-url" required data-i18n-placeholder="urlPlaceholder" placeholder="https://google.com" autocomplete="off">
          </div>
          <div class="modal-actions">
            <button type="button" id="cancel-btn" class="btn-secondary" data-i18n="cancel">Cancelar</button>
            <button type="submit" class="btn-primary" data-i18n="save">Guardar</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal Add/Edit GROUP -->
    <div id="group-modal" class="modal hidden">
      <div class="modal-content glass-panel" style="max-width: 360px;">
        <div class="modal-header">
          <h2 id="group-modal-title"><span data-i18n="addGroup">A√±adir Grupo</span></h2>
          <button id="close-group-modal" class="btn-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>
        <form id="group-form">
          <div class="form-group">
            <label for="group-title" data-i18n="groupName">Nombre del Grupo</label>
            <input type="text" id="group-title" required placeholder="Ej: Trabajo" autocomplete="off">
          </div>
          <div class="modal-actions">
            <button type="button" id="cancel-group-btn" class="btn-secondary" data-i18n="cancel">Cancelar</button>
            <button type="submit" class="btn-primary" data-i18n="save">Guardar</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal Editar Grupo Avanzado (V14) -->
    <div id="advanced-group-modal" class="modal hidden" style="align-items: center; padding: 2rem;">
      <div id="advanced-modal-content" class="modal-content advanced-modal-content"
        style="max-width: 850px; width: 100%; max-height: 90vh; padding: 0; display: flex; flex-direction: column; background: #222; border-radius: 8px; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); position: relative; transition: none;">

        <!-- Header -->
        <div id="advanced-modal-drag-handle" class="advanced-modal-header"
          style="display: flex; justify-content: space-between; align-items: center; background: #004d60; padding: 0.75rem 1rem; color: white; cursor: grab;">
          <div style="display: flex; align-items: center; gap: 0.75rem;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
              <line x1="3" y1="12" x2="21" y2="12"></line>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
            <h2 id="advanced-group-modal-title" style="font-size: 1.1rem; font-weight: 500;">Editar grupo: ""</h2>
          </div>
          <div style="display: flex; gap: 0.5rem;">
            <button class="btn-icon" style="color: white;"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2" class="icon-small">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                <line x1="8" y1="21" x2="16" y2="21"></line>
                <line x1="12" y1="17" x2="12" y2="21"></line>
              </svg></button>
            <button id="close-advanced-group-modal" class="btn-icon"
              style="color: white; opacity: 0.8; transition: opacity 0.2s;">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
                <path d="M18 6L6 18M6 6l12 12" />
              </svg>
            </button>
          </div>
        </div>

        <!-- Body -->
        <div style="display: flex; flex: 1; height: 500px; overflow: hidden;">
          <!-- Sidebar -->
          <div class="advanced-sidebar" style="overflow-y: auto;">
            <button class="adv-sidebar-btn active" data-tab="tab-general">
              <svg viewBox="0 0 24 24" fill="none" class="icon-small" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
              </svg><span data-i18n="general">General</span></button>
            <button class="adv-sidebar-btn" data-tab="tab-apariencia">
              <svg viewBox="0 0 24 24" fill="none" class="icon-small" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <circle cx="12" cy="12" r="4"></circle>
                <line x1="4.93" y1="4.93" x2="9.17" y2="9.17"></line>
              </svg><span data-i18n="appearance">Apariencia</span></button>
            <button class="adv-sidebar-btn" data-tab="tab-fondo">
              <svg viewBox="0 0 24 24" fill="none" class="icon-small" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg><span data-i18n="background">Fondo</span></button>
            <button class="adv-sidebar-btn" data-tab="tab-diapositivas">
              <svg viewBox="0 0 24 24" fill="none" class="icon-small" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
              </svg><span data-i18n="slides">Diapositivas</span></button>
            <button class="adv-sidebar-btn" data-tab="tab-configuracion">
              <svg viewBox="0 0 24 24" fill="none" class="icon-small" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg><span data-i18n="settings">Configuraci√≥n</span></button>
          </div>

          <!-- Content Panels -->
          <div class="advanced-content" style="flex: 1; padding: 1.5rem 2rem; background: #1a1a1a; overflow-y: auto;">
            <!-- GENERAL TAB -->
            <div id="tab-general" class="adv-tab-content active">

              <!-- Fila: Nombre y Posici√≥n -->
              <div style="display: flex; gap: 1rem; margin-bottom: 2rem; margin-top: 0.5rem;">
                <div
                  style="flex: 1; position: relative; border: 1px solid #0ea5e9; border-radius: 4px; padding: 0.6rem; background: rgba(0,0,0,0.1);">
                  <span
                    style="position: absolute; top: -10px; left: 10px; background: #1a1a1a; padding: 0 5px; color: #0ea5e9; font-size: 0.75rem;"><span data-i18n="nameLabel">Nombre:</span></span>
                  <input type="text" id="adv-group-title-input" value="Predeterminado"
                    style="width: 100%; border: none; background: transparent; color: white; font-size: 0.95rem; outline: none; font-family: inherit;">
                </div>

                <div
                  style="width: 120px; position: relative; border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; padding: 0.6rem; display: flex; align-items: center; justify-content: space-between; background: rgba(0,0,0,0.1);">
                  <span
                    style="position: absolute; top: -10px; left: 10px; background: #1a1a1a; padding: 0 5px; color: var(--text-secondary); font-size: 0.75rem;"><span data-i18n="positionLabel">Posici√≥n</span></span>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small"
                    style="color:var(--text-secondary);">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  </svg>
                  <span style="font-size: 1rem;">1</span>
                  <div style="display: flex; flex-direction: column; gap: 2px;">
                    <button
                      style="background:white; border:none; color:black; font-size:8px; cursor:pointer; width:12px; height:10px; display:flex; align-items:center; justify-content:center;">‚ñ≤</button>
                    <button
                      style="background:white; border:none; color:black; font-size:8px; cursor:pointer; width:12px; height:10px; display:flex; align-items:center; justify-content:center;">‚ñº</button>
                  </div>
                </div>
              </div>

              <div class="adv-section-divider"></div>

              <!-- Fila: Columnas y Filas -->
              <div style="display: flex; gap: 2rem; margin-bottom: 2rem;">
                <div
                  style="position: relative; border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; padding: 0.6rem; display: flex; align-items: center; gap: 1rem; background: rgba(0,0,0,0.3); min-width: 140px;">
                  <span
                    style="position: absolute; top: -10px; left: 10px; background: #1a1a1a; padding: 0 5px; color: var(--text-secondary); font-size: 0.75rem;"><span data-i18n="columnsLabel">Columnas:</span></span>
                  <div style="width: 16px; height: 12px; background: white; border-radius: 2px;"></div>
                  <span id="adv-group-cols-val" style="font-size: 1.1rem; flex: 1;">4</span>
                  <div style="display: flex; flex-direction: column; gap: 2px;">
                    <button id="adv-group-cols-up"
                      style="background:white; border:none; color:black; font-size:8px; cursor:pointer; width:12px; height:10px; display:flex; align-items:center; justify-content:center;">‚ñ≤</button>
                    <button id="adv-group-cols-down"
                      style="background:white; border:none; color:black; font-size:8px; cursor:pointer; width:12px; height:10px; display:flex; align-items:center; justify-content:center;">‚ñº</button>
                  </div>
                </div>

                <div
                  style="position: relative; border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; padding: 0.6rem; display: flex; align-items: center; gap: 1rem; background: rgba(0,0,0,0.3); min-width: 140px;">
                  <span
                    style="position: absolute; top: -10px; left: 10px; background: #1a1a1a; padding: 0 5px; color: var(--text-secondary); font-size: 0.75rem;"><span data-i18n="rowsLabel">Filas:</span></span>
                  <div style="width: 16px; height: 12px; background: white; border-radius: 2px;"></div>
                  <span id="adv-group-rows-val" style="font-size: 1.1rem; flex: 1;">5</span>
                  <div style="display: flex; flex-direction: column; gap: 2px;">
                    <button id="adv-group-rows-up"
                      style="background:white; border:none; color:black; font-size:8px; cursor:pointer; width:12px; height:10px; display:flex; align-items:center; justify-content:center;">‚ñ≤</button>
                    <button id="adv-group-rows-down"
                      style="background:white; border:none; color:black; font-size:8px; cursor:pointer; width:12px; height:10px; display:flex; align-items:center; justify-content:center;">‚ñº</button>
                  </div>
                </div>
              </div>

              <div class="adv-section-divider"></div>

              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 style="font-size: 1.1rem; font-weight: 500;"><span data-i18n="groupLayout">Dise√±o de grupo</span></h3>
                <a href="#" style="color: #0ea5e9; font-size: 0.85rem; text-decoration: none;">Documentaci√≥n en
                  l√≠nea</a>
              </div>

              <div class="adv-radio-group" style="margin-bottom: 2rem;">
                <label class="adv-radio-label" style="align-items: center;">
                  <span style="display:flex; align-items:center; gap:0.5rem;"><input type="radio"
                      id="adv-layout-dynamic" name="dg" class="adv-radio"><span data-i18n="dynamic">Din√°mico</span></span>
                  <span style="margin-left:auto; display:flex; align-items:center; gap:1rem; font-size:0.85rem;"><span data-i18n="slideSize">Tama√±o de la diapositiva:</span><div class="adv-input-group"><button id="adv-dyn-w-down" class="btn-spinner">-</button><input
                        type="text" id="adv-dyn-w-val" value="240"
                        style="width:40px; text-align:center; border:none; background:transparent; color:white; font-family:monospace;"><button
                        id="adv-dyn-w-up" class="btn-spinner">+</button> px</div>
                    x
                    <div class="adv-input-group"><button id="adv-dyn-h-down" class="btn-spinner">-</button><input
                        type="text" id="adv-dyn-h-val" value="180"
                        style="width:40px; text-align:center; border:none; background:transparent; color:white; font-family:monospace;"><button
                        id="adv-dyn-h-up" class="btn-spinner">+</button> px</div>
                  </span>
                </label>

                <label class="adv-radio-label" style="align-items: flex-start;">
                  <span style="display:flex; align-items:center; gap:0.5rem; margin-top: 0.2rem;"><input type="radio"
                      id="adv-layout-list" name="dg" class="adv-radio"><span data-i18n="dynamicList">Din√°mico - lista</span></span>
                  <div
                    style="margin-left:auto; display:flex; flex-direction: column; align-items: flex-end; gap:0.5rem; font-size:0.85rem;">
                    <div style="display:flex; align-items:center; gap:1rem;"><span data-i18n="direction">Direcci√≥n:</span><label
                        style="display:flex; align-items:center; gap:0.25rem; font-weight: normal; cursor:pointer;"><input
                          type="radio" name="dg_list_dir" id="adv-list-dir-h" class="adv-radio"><span data-i18n="horizontal">Horizontal</span></label>
                      <label
                        style="display:flex; align-items:center; gap:0.25rem; font-weight: normal; cursor:pointer;"><input
                          type="radio" name="dg_list_dir" id="adv-list-dir-v" class="adv-radio" checked><span data-i18n="vertical">Vertical</span></label>
                    </div>
                    <div style="display:flex; align-items:center; gap:1rem;"><span data-i18n="columnWidth">Ancho de columna:</span><div class="adv-input-group"><button id="adv-list-w-down" class="btn-spinner">-</button><input
                          type="text" id="adv-list-w-val" value="240"
                          style="width:40px; text-align:center; border:none; background:transparent; color:white; font-family:monospace;"><button
                          id="adv-list-w-up" class="btn-spinner">+</button> px</div>
                    </div>
                  </div>
                </label>

                <div
                  style="background: rgba(14, 165, 233, 0.05); padding: 1rem; border-radius: 4px; border: 1px solid rgba(14, 165, 233, 0.2); margin-top: 0.5rem;">
                  <label class="adv-radio-label"><span
                      style="display:flex; align-items:center; gap:0.5rem; font-weight: 500; color: #0ea5e9;"><input
                        type="radio" id="adv-layout-grid" name="dg" class="adv-radio" checked><span data-i18n="grid">Cuadr√≠cula</span></span></label>

                  <div style="display: flex; flex-direction: column; gap: 1rem; padding-left: 2rem; margin-top: 1rem;">
                    <label style="display:flex; align-items:center; justify-content: space-between; cursor:pointer;">
                      <span style="display:flex; align-items:center; gap:0.5rem;"><input type="radio" id="adv-grid-fill"
                          name="dg_sub" checked class="adv-radio"><span data-i18n="fillGap">Rellenar hueco</span></span>
                      <span
                        style="background:rgba(255,255,255,0.1); width:20px; height:20px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:0.8rem; font-weight:bold; color: var(--text-secondary);">?</span>
                    </label>

                    <label style="display:flex; align-items:center; justify-content: space-between; cursor:pointer;">
                      <span style="display:flex; align-items:center; gap:0.5rem;"><input type="radio"
                          id="adv-grid-center" name="dg_sub" class="adv-radio"><span data-i18n="centerSlides">Centrar diapositivas</span></span>
                      <span style="display:flex; align-items:center; gap:1rem; font-size:0.85rem;"><span data-i18n="aspectRatio">Relaci√≥n de aspecto de la diapositiva:</span><div class="adv-input-group">
                          <input type="text" id="adv-grid-aw-val" value="16"
                            style="width:30px; text-align:center; border:none; background:transparent; color:white; font-family:monospace;">
                          <div style="width:12px; display:flex; flex-direction:column;"><button id="adv-grid-aw-up"
                              class="btn-spinner" style="font-size:6px; padding:0;">‚ñ≤</button><button
                              id="adv-grid-aw-down" class="btn-spinner" style="font-size:6px; padding:0;">‚ñº</button>
                          </div>
                        </div>
                        :
                        <div class="adv-input-group">
                          <input type="text" id="adv-grid-ah-val" value="12"
                            style="width:30px; text-align:center; border:none; background:transparent; color:white; font-family:monospace;">
                          <div style="width:12px; display:flex; flex-direction:column;"><button id="adv-grid-ah-up"
                              class="btn-spinner" style="font-size:6px; padding:0;">‚ñ≤</button><button
                              id="adv-grid-ah-down" class="btn-spinner" style="font-size:6px; padding:0;">‚ñº</button>
                          </div>
                        </div>
                      </span>
                    </label>
                  </div>
                </div>
              </div>
            </div>

            <!-- APARIENCIA TAB -->
            <div id="tab-apariencia" class="adv-tab-content hidden">
              <div class="adv-section-divider"></div>

              <h3 style="font-size: 1.1rem; font-weight: 500; margin-bottom: 1rem;"><span data-i18n="groupIcon">Icono del grupo</span></h3>
              <div id="adv-icon-grid"
                style="background: rgba(0,0,0,0.3); border-radius: 8px; padding: 1rem; display: grid; grid-template-columns: repeat(16, 1fr); gap: 10px; margin-bottom: 2rem;">
                <div class="adv-icon-choice active" data-icon="‚úñ">‚úñ</div>
                <div class="adv-icon-choice" data-icon="üè∑">üè∑</div>
                <div class="adv-icon-choice" data-icon="üîñ">üîñ</div>
                <div class="adv-icon-choice" data-icon="‚≠ê">‚≠ê</div>
                <div class="adv-icon-choice" data-icon="üåô">üåô</div>
                <div class="adv-icon-choice" data-icon="‚òÄ">‚òÄ</div>
                <div class="adv-icon-choice" data-icon="‚òÅ">‚òÅ</div>
                <div class="adv-icon-choice" data-icon="‚ö°">‚ö°</div>
                <div class="adv-icon-choice" data-icon="üî•">üî•</div>
                <div class="adv-icon-choice" data-icon="üíß">üíß</div>
                <div class="adv-icon-choice" data-icon="üí°">üí°</div>
                <div class="adv-icon-choice" data-icon="üè†">üè†</div>
                <div class="adv-icon-choice" data-icon="üè¢">üè¢</div>
                <div class="adv-icon-choice" data-icon="‚öô">‚öô</div>
                <div class="adv-icon-choice" data-icon="üõ†">üõ†</div>
                <div class="adv-icon-choice" data-icon="üìÅ">üìÅ</div>
                <div class="adv-icon-choice" data-icon="üìÇ">üìÇ</div>
                <div class="adv-icon-choice" data-icon="üõí">üõí</div>
                <div class="adv-icon-choice" data-icon="üíº">üíº</div>
                <div class="adv-icon-choice" data-icon="üéÆ">üéÆ</div>
                <div class="adv-icon-choice" data-icon="üéµ">üéµ</div>
                <div class="adv-icon-choice" data-icon="üé•">üé•</div>
                <div class="adv-icon-choice" data-icon="üì∑">üì∑</div>
                <div class="adv-icon-choice" data-icon="üìö">üìö</div>
                <div class="adv-icon-choice" data-icon="‚ù§">‚ù§</div>
                <div class="adv-icon-choice" data-icon="üåç">üåç</div>
                <div class="adv-icon-choice" data-icon="‚úà">‚úà</div>
                <div class="adv-icon-choice" data-icon="üöó">üöó</div>
                <div class="adv-icon-choice" data-icon="üö≤">üö≤</div>
                <div class="adv-icon-choice" data-icon="üöÄ">üöÄ</div>
                <div class="adv-icon-choice" data-icon="üéÅ">üéÅ</div>
                <div class="adv-icon-choice" data-icon="üèÜ">üèÜ</div>
                <div class="adv-icon-choice" data-icon="‚öΩ">‚öΩ</div>
                <div class="adv-icon-choice" data-icon="üé®">üé®</div>
                <div class="adv-icon-choice" data-icon="üçî">üçî</div>
                <div class="adv-icon-choice" data-icon="‚òï">‚òï</div>
                <div class="adv-icon-choice" data-icon="üê∂">üê∂</div>
                <div class="adv-icon-choice" data-icon="üê±">üê±</div>
                <div class="adv-icon-choice" data-icon="üå∏">üå∏</div>
                <div class="adv-icon-choice" data-icon="üå≤">üå≤</div>
                <div class="adv-icon-choice" data-icon="üíé">üíé</div>
                <div class="adv-icon-choice" data-icon="‚åö">‚åö</div>
                <div class="adv-icon-choice" data-icon="üíª">üíª</div>
                <div class="adv-icon-choice" data-icon="üì±">üì±</div>
                <div class="adv-icon-choice" data-icon="‚úâ">‚úâ</div>
                <div class="adv-icon-choice" data-icon="‚úè">‚úè</div>
                <div class="adv-icon-choice" data-icon="üîí">üîí</div>
                <div class="adv-icon-choice" data-icon="üîë">üîë</div>
                <div class="adv-icon-choice" data-icon="‚úÖ">‚úÖ</div>
              </div>

              <div class="adv-section-divider"></div>

              <div style="display: flex; align-items: center; justify-content: space-between;">
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                  <input type="checkbox" id="adv-text-color-enable" style="width: 16px; height: 16px;">
                  Color del texto de las diapositivas
                </label>
                <div style="display: flex; align-items: center; gap: 1rem;">
                  <span id="adv-text-color-hex"
                    style="color: var(--text-secondary); font-family: monospace;">#FFFFFF</span>
                  <input type="color" id="adv-text-color-picker" value="#ffffff"
                    style="width: 28px; height: 28px; border: none; border-radius: 4px; padding: 0; cursor: pointer; background: transparent;">
                </div>
              </div>
            </div>

            <!-- FONDO TAB -->
            <div id="tab-fondo" class="adv-tab-content hidden">
              <div class="adv-accordion">
                <!-- 1. NINGUNO -->
                <div class="adv-accordion-header">
                  <label><input type="radio" name="bg" id="adv-bg-none" value="none"> Ninguno</label><span>‚åÑ</span>
                </div>
                <!-- 2. COLOR SOLIDO -->
                <div class="adv-accordion-header">
                  <label><input type="radio" name="bg" id="adv-bg-solid" value="solid"> Color
                    s√≥lido</label><span>‚åÑ</span>
                </div>
                <div class="adv-accordion-body hidden" id="adv-bg-solid-body" style="padding: 1.5rem 1rem;">
                  <div
                    style="display: flex; align-items: center; gap: 1rem; background: rgba(0,0,0,0.3); padding: 0.75rem 1.5rem; border-radius: 4px; border: 1px solid rgba(255,255,255,0.05); width: fit-content;">
                    <span id="adv-bg-solid-hex"
                      style="color: var(--text-secondary); font-family: monospace;">#28005F</span>
                    <input type="color" id="adv-bg-solid-color" value="#28005f"
                      style="width: 24px; height: 24px; border: none; padding: 0; cursor: pointer; background: transparent;">
                  </div>
                </div>
                <!-- 3. GRADIENTE -->
                <div class="adv-accordion-header active" style="color: #0ea5e9;">
                  <label><input type="radio" name="bg" id="adv-bg-gradient" value="gradient" checked> Colores
                    degradados</label><span>‚åÉ</span>
                </div>
                <div class="adv-accordion-body" id="adv-bg-gradient-body"
                  style="display: flex; gap: 4rem; padding: 1.5rem 1rem;">
                  <div>
                    <p style="margin-bottom: 0.75rem; font-size: 0.85rem; color: var(--text-secondary);">Tipo de
                      gradiente:</p>
                    <label
                      style="display: flex; gap:0.5rem; align-items:center; margin-bottom: 0.5rem; font-size:0.95rem;">
                      <input type="radio" name="grad" id="adv-bg-grad-linear" value="linear"> Lineal
                    </label>
                    <label
                      style="display: flex; gap:0.5rem; align-items:center; margin-bottom: 0.5rem; font-size:0.95rem;">
                      <input type="radio" name="grad" id="adv-bg-grad-ellipse" value="radial-ellipse" checked> Radial -
                      elipse
                    </label>
                    <label
                      style="display: flex; gap:0.5rem; align-items:center; margin-bottom: 0.5rem; font-size:0.95rem;">
                      <input type="radio" name="grad" id="adv-bg-grad-circle" value="radial-circle"> Radial - c√≠rculo
                    </label>
                  </div>
                  <div>
                    <p style="margin-bottom: 0.75rem; font-size: 0.85rem; color: var(--text-secondary);">Colores
                      degradados:</p>
                    <div
                      style="display: flex; align-items: center; gap: 1rem; background: rgba(0,0,0,0.3); padding: 0.75rem 1.5rem; border-radius: 4px; border: 1px solid rgba(255,255,255,0.05); margin-bottom: 0.5rem;">
                      <span id="adv-bg-grad-hex1"
                        style="color: var(--text-secondary); font-family: monospace;">#3B82F6</span>
                      <input type="color" id="adv-bg-grad-color1" value="#3b82f6"
                        style="width: 24px; height: 24px; border: none; padding: 0; cursor: pointer; background: transparent;">
                    </div>
                    <div
                      style="display: flex; align-items: center; gap: 1rem; background: rgba(0,0,0,0.3); padding: 0.75rem 1.5rem; border-radius: 4px; border: 1px solid rgba(255,255,255,0.05);">
                      <span id="adv-bg-grad-hex2"
                        style="color: var(--text-secondary); font-family: monospace;">#0F172A</span>
                      <input type="color" id="adv-bg-grad-color2" value="#0f172a"
                        style="width: 24px; height: 24px; border: none; padding: 0; cursor: pointer; background: transparent;">
                    </div>
                  </div>
                </div>

              </div>
            </div>

            <!-- DIAPOSITIVAS TAB -->
            <div id="tab-diapositivas" class="adv-tab-content hidden">
              <h3 style="font-size: 1.1rem; font-weight: 500; margin-bottom: 1rem;">Dise√±o</h3>
              <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
                <label style="display: flex; align-items: center; gap: 0.5rem;">
                  <input type="checkbox" id="adv-gap-enable"> Espacio entre diapositivas:
                </label>
                <input type="range" id="adv-gap-range" style="flex: 1;" min="0" max="100" value="20">
                <span id="adv-gap-val" style="font-size: 0.85rem; color: var(--text-secondary);">20px</span>
              </div>

              <div class="adv-section-divider"></div>

              <h3 style="font-size: 1.1rem; font-weight: 500; margin-bottom: 1rem;">Acciones</h3>
              <div style="margin-bottom: 2rem;">

                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                  <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                    <input type="checkbox" id="adv-open-window"> Abrir siempre en una nueva ventana
                  </label>
                  <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                    <input type="checkbox" id="adv-open-tab"> Siempre abrir en una nueva pesta√±a
                  </label>
                </div>
              </div>
            </div>

            <!-- CONFIGURACION TAB -->
            <div id="tab-configuracion" class="adv-tab-content hidden">
              <div style="display: flex; flex-direction: column; gap: 1.5rem; margin-bottom: 2rem;">
                <div>
                  <label
                    style="display: flex; align-items: center; gap: 0.5rem; font-weight: 500; margin-bottom: 0.25rem;">
                    <input type="checkbox" id="adv-set-default"><span data-i18n="default">Predeterminado</span></label>
                  <p style="font-size: 0.85rem; color: var(--text-secondary); margin-left: 1.75rem;">Abrir este
                    grupo al
                    inicio</p>
                </div>

                <div>
                  <label
                    style="display: flex; align-items: center; gap: 0.5rem; font-weight: 500; margin-bottom: 0.25rem;">
                    <input type="checkbox" id="adv-is-locked"><span data-i18n="lockGroup">Bloquear este grupo</span></label>
                  <p style="font-size: 0.85rem; color: var(--text-secondary); margin-left: 1.75rem; line-height: 1.4;">
                    Solo podr√°s abrir este grupo al introducir su contrase√±a. <br>Los datos del grupo
                    bloqueado
                    NO est√°n encriptados. Un programador h√°bil con acceso directo a tu ordenador podr√≠a llegar a
                    superar
                    el bloqueo sin la contrase√±a.</p>

                  <div id="adv-password-container" style="display: none; margin-left: 1.75rem; margin-top: 1rem;">
                    <label for="adv-group-password"
                      style="font-size: 0.85rem; color: var(--text-secondary); display: block; margin-bottom: 0.5rem;">Contrase√±a
                      de este grupo:</label>
                    <input type="password" id="adv-group-password" placeholder="Establecer contrase√±a..."
                      style="width: 100%; padding: 0.5rem; border-radius: 4px; background: rgba(0,0,0,0.4); color: white; border: 1px solid rgba(255,255,255,0.2); outline: none; font-size: 0.9rem;">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Footer Actions -->
        <div class="advanced-modal-footer"
          style="display: flex; background: #1a1a1a; padding: 1rem; border-top: 1px solid rgba(255,255,255,0.05);">
          <button id="adv-group-save-btn" class="btn-primary"
            style="background: #0ea5e9; color: white; border-radius: 4px; padding: 0.6rem 1.25rem; font-weight: 600; font-size: 0.85rem; display: flex; align-items: center; gap: 0.5rem; border: none; letter-spacing: 0.05em;">
            <svg viewBox="0 0 24 24" fill="none" class="icon-small" stroke="currentColor" stroke-width="2">
              <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
              <polyline points="17 21 17 13 7 13 7 21"></polyline>
              <polyline points="7 3 7 8 15 8"></polyline>
            </svg>
            GUARDAR CAMBIOS
          </button>
          <button id="adv-group-discard-btn" class="btn-secondary"
            style="background: transparent; color: var(--text-secondary); border-radius: 4px; border: none; padding: 0.6rem 1.25rem; font-weight: 600; font-size: 0.85rem; display: flex; align-items: center; gap: 0.5rem; margin-left:1rem;">
            <svg viewBox="0 0 24 24" fill="none" class="icon-small" stroke="currentColor" stroke-width="2">
              <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
              <polyline points="3 3 3 8 8 8"></polyline>
            </svg>
            DESCARTAR CAMBIOS
          </button>
        </div>

      </div>
    </div>

    <!-- Modal Estad√≠sticas -->
    <div id="stats-modal" class="modal hidden">
      <div class="modal-content glass-panel" style="max-width: 400px;">
        <div class="modal-header">
          <h2>Estad√≠sticas</h2>
          <button id="close-stats-modal" class="btn-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div style="display: flex; flex-direction: column; gap: 1rem; margin-top: 1rem;">
          <div
            style="display: flex; justify-content: space-between; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: var(--radius-md);">
            <span>Total de Grupos:</span>
            <strong id="stats-total-groups" style="color: var(--primary-color);">0</strong>
          </div>
          <div
            style="display: flex; justify-content: space-between; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: var(--radius-md);">
            <span>Total de Marcadores:</span>
            <strong id="stats-total-dials" style="color: var(--primary-color);">0</strong>
          </div>
          <div
            style="display: flex; justify-content: space-between; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: var(--radius-md);">
            <span>Promedio Marcadores/Grupo:</span>
            <strong id="stats-avg-dials" style="color: var(--primary-color);">0.0</strong>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Registro de Errores -->
    <div id="errors-modal" class="modal hidden">
      <div class="modal-content glass-panel" style="max-width: 600px; width: 90%;">
        <div class="modal-header">
          <h2>Registro de Errores</h2>
          <button id="close-errors-modal" class="btn-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div style="margin-top: 1rem;">
          <textarea id="errors-log-area" readonly
            style="width: 100%; height: 250px; background: rgba(0,0,0,0.3); color: #a1a1aa; border: 1px solid rgba(255,255,255,0.1); border-radius: var(--radius-md); padding: 1rem; font-family: monospace; resize: vertical;"
            placeholder="No se han registrado errores en esta sesi√≥n."></textarea>
        </div>
        <div class="modal-actions" style="margin-top: 1.5rem;">
          <button type="button" id="clear-errors-btn" class="btn-secondary">Limpiar Registro</button>
        </div>
      </div>
    </div>

    <!-- Modal Buscador Global de Diapositivas -->
    <div id="search-modal" class="modal hidden" style="align-items: flex-start; padding-top: 15vh;">
      <div class="modal-content glass-panel" style="max-width: 650px; width: 95%;">
        <div class="modal-header" style="border-bottom: none; padding-bottom: 0;">
          <div style="width: 100%; position: relative;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon"
              style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary);">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
            <input type="text" id="search-dial-input" placeholder="Buscar marcadores (Ctrl+Shift+F)..."
              autocomplete="off"
              style="width: 100%; padding: 1.2rem 1rem 1.2rem 3.5rem; font-size: 1.25rem; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); border-radius: var(--radius-md); color: var(--text-primary); outline: none;">
          </div>
          <button id="close-search-modal" class="btn-icon" style="position: absolute; right: 1.5rem; top: 1.5rem;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div id="search-results-container"
          style="display: flex; flex-direction: column; max-height: 50vh; overflow-y: auto; margin-top: 1rem;">
          <!-- Resultados din√°micos aqu√≠ -->
        </div>
      </div>
    </div>

    <!-- Modal Compartir Diapositivas Avanzado (Fase V13) -->
    <div id="share-modal-advanced" class="modal hidden" style="align-items: flex-start; padding-top: 10vh;">
      <div class="modal-content glass-panel" style="max-width: 700px; width: 95%;">

        <div class="modal-header"
          style="border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 1.5rem; margin-bottom: 1.5rem;">
          <div style="display: flex; align-items: center; gap: 1rem;">
            <svg viewBox="0 0 24 24" fill="none" class="icon" stroke="currentColor" stroke-width="2">
              <circle cx="18" cy="5" r="3"></circle>
              <circle cx="6" cy="12" r="3"></circle>
              <circle cx="18" cy="19" r="3"></circle>
              <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
              <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
            </svg>
            <h2 style="font-size: 1.25rem;">Compartir diapositivas</h2>
          </div>
          <button id="close-advanced-share-modal" class="btn-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>

        <div style="display: flex; gap: 1rem; align-items: center; margin-bottom: 1.5rem;">
          <button id="btn-back-to-selection" class="btn-secondary"
            style="font-size: 0.8rem; padding: 0.5rem 1rem; display: flex; align-items: center; gap: 0.5rem;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              style="width: 14px; height: 14px;">
              <path d="M9 14l-4-4 4-4"></path>
              <path d="M5 10h11a4 4 0 1 1 0 8h-1"></path>
            </svg>
            SELECCIONAR DIAPOSITIVAS
          </button>
          <span id="share-modal-count-text" style="color: var(--text-secondary); font-size: 0.9rem;">Seleccionado:
            0</span>
        </div>

        <p id="share-modal-subtitle-text" style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
          diapositivas / 0 grupos</p>

        <!-- Dynamic List -->
        <div id="share-selected-list" class="share-selected-list-container">
          <!-- Renderizado por JS -->
        </div>

        <div style="margin-top: 1.5rem;">
          <label style="color: var(--text-secondary); font-size: 0.85rem; display: block; margin-bottom: 0.5rem;">Titula
            esta selecci√≥n</label>
          <div style="display: flex; gap: 1rem; align-items: center;">
            <input type="text" id="share-title-input" value="Mis Diapositivas Compartidas"
              style="flex: 1; padding: 0.75rem 1rem; font-size: 1rem; background: rgba(0,0,0,0.2); border: 1px solid #3b82f6; border-radius: 4px; color: var(--text-primary); outline: none;">
          </div>
          <p style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.75rem;">Exporta estas
            diapositivas a
            un archivo Bookmarks HTML est√°ndar o c√≥pialo en texto plano al portapapeles.</p>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
          <button id="share-advanced-copy-btn" class="btn-secondary"
            style="flex:1; padding: 0.85rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem; font-weight: 500;">
            <svg viewBox="0 0 24 24" fill="none" class="icon" stroke="currentColor" stroke-width="2">
              <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
              <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
            </svg>
            COPIAR COMO TEXTO
          </button>
          <button id="share-advanced-export-btn" class="btn-primary"
            style="flex:1; padding: 0.85rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem; font-weight: 500; background: #0ea5e9;">
            <svg viewBox="0 0 24 24" fill="none" class="icon" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            DESCAGAR HTML
          </button>
        </div>
      </div>
    </div>


    <!-- Settings Menu (Sidebar) -->
    <div id="settings-sidebar" class="sidebar hidden">
      <div class="sidebar-content glass-panel">
        <div class="sidebar-header">
          <h2>Ajustes Globales</h2>
          <button id="close-settings" class="btn-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>

        <div class="settings-section">
          <h3>Modo Edici√≥n</h3>
          <p>Activa para mover, a√±adir, borrar o reorganizar grupos y marcadores.</p>
          <button id="toggle-edit-mode" class="btn-primary w-full">üõ†Ô∏è Activar Modo Edici√≥n</button>
        </div>

        <div class="settings-section">
          <h3>Importar / Exportar</h3>
          <p>Migra tus datos desde otras extensiones.</p>
          <button id="settings-import-native-btn" class="btn-secondary w-full" style="margin-bottom: 0.5rem;">ü¶ä
            Importar del Navegador</button>

          <input type="file" id="settings-import-html-input" accept=".html" style="display: none;">
          <button id="settings-import-html-btn" class="btn-secondary w-full" style="margin-bottom: 0.5rem;">üì•
            Importar
            .HTML</button>
        </div>

        <div class="settings-section">
          <h3>Acerca de</h3>
          <p>vddgroupdial V5</p>
        </div>

      </div>
    </div>

    <!-- START ONBOARDING MODAL -->
    <div id="onboarding-modal" class="modal hidden" style="z-index: 100;">
      <div class="modal-content glass-panel" style="max-width: 500px; text-align: center; padding: 3rem 2rem;">
        <h2
          style="font-size: 2rem; margin-bottom: 1rem; background: linear-gradient(135deg, #60a5fa, #a855f7); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
          ¬°Bienvenido a vddgroupdial!</h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem; line-height: 1.5; font-size: 1.1rem;">
          Parece que no tienes marcadores organizados aqu√≠ todav√≠a. ¬øTe gustar√≠a importar los tuyos para empezar a
          darles estilo?
        </p>

        <div style="display: flex; flex-direction: column; gap: 1rem;">
          <button id="onboarding-native-btn" class="btn-primary w-full"
            style="padding: 1rem; font-size: 1.1rem; justify-content: center;">
            ü¶ä Importar Marcadores del Navegador
          </button>

          <div style="position: relative;">
            <input type="file" id="onboarding-html-input" accept=".html" style="display: none;">
            <button id="onboarding-html-btn" class="btn-secondary w-full"
              style="padding: 1rem; font-size: 1.1rem; justify-content: center;">
              üìÑ Importar desde Archivo HTML
            </button>
          </div>

          <button id="skip-onboarding-btn" class="btn-icon"
            style="margin-top: 1rem; width: 100%; text-decoration: underline; font-size: 0.9rem; justify-content: center; border-radius: 8px;">
            Omitir por ahora, a√±adir√© manualmente
          </button>
        </div>
      </div>
    </div>
    <!-- END ONBOARDING MODAL -->
    <!-- Barra Inferior Flotante Selector (Avanzado) -->
    <div id="share-bottom-bar" class="share-bottom-bar hidden">
      <div class="share-top-row-indicator">
        <div class="share-icon-title">
          <svg viewBox="0 0 24 24" fill="none" class="icon" stroke="currentColor" stroke-width="2">
            <circle cx="18" cy="5" r="3"></circle>
            <circle cx="6" cy="12" r="3"></circle>
            <circle cx="18" cy="19" r="3"></circle>
            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
          </svg>
          Compartir diapositivas
        </div>
        <div id="share-bottom-count" class="share-selection-count">
          Seleccionado: 0 diapositivas / 0 grupos
        </div>
      </div>
      <div class="share-bar-controls">
        <button id="share-bottom-select-all-btn" class="btn-secondary"
          style="padding: 0.5rem 1rem; font-size: 0.85rem; border-color: rgba(255,255,255,0.2);">
          ‚òë Seleccionar Todo
        </button>
        <button id="share-bottom-cancel-btn" class="btn-secondary" style="padding: 0.5rem 1rem; font-size: 0.85rem;">
          Cancelar
        </button>
        <button id="share-bottom-up-btn" class="btn-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon"
            style="width: 24px; height: 24px;">
            <polyline points="18 15 12 9 6 15"></polyline>
          </svg>
        </button>
      </div>
    </div>

  </div>

  <!-- Men√∫ Contextual de Diales (Fase V19) -->
  <div id="custom-context-menu" class="dropdown-menu"
    style="display: none; position: absolute; z-index: 9999; min-width: 220px; box-shadow: 0 10px 30px rgba(0,0,0,0.5);">
    <button class="dropdown-item" id="ctx-sort-name-asc">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
        <path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"></path>
        <path d="M4 4h4v4H4zM16 16h4v4h-4z"></path>
      </svg>
      Ordenar por Nombre (A-Z)
    </button>
    <button class="dropdown-item" id="ctx-sort-name-desc">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
        <path d="M15 21h6v-6M9 3H3v6M21 21l-7-7M3 3l7 7"></path>
        <path d="M4 16h4v4H4zM16 4h4v4h-4z"></path>
      </svg>
      Ordenar por Nombre (Z-A)
    </button>
    <div class="dropdown-divider"></div>
    <button class="dropdown-item" id="ctx-sort-date-asc">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
      M√°s antiguos primero
    </button>
    <button class="dropdown-item" id="ctx-sort-date-desc">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-small">
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 8 14"></polyline>
      </svg>
      M√°s recientes primero
    </button>
  </div>

  </div>
</body>

</html>